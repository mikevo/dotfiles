#!/bin/sh

log() {
    printf "       %s\n" "$1"
}

log_output() {
    while IFS= read -r line; do
        log "$line"
    done
}

log_end() {
    printf "%s\n" "$1"
}


log_update() {
  text="UPDATE [$1] "
  printf "%s" "$text"
  cols=$(tput cols)
  text_len=${#text}
  [ "$text_len" -lt "$cols" ] && \
    printf '%*s\n' $((cols - text_len)) '' | tr ' ' '-' || echo
}


log_update "System software"
if [ -x "$(command -v dnf)" ]
then
    sudo dnf upgrade
elif [ -x "$(command -v apt)" ]
then
    sudo apt update 2>&1 | log_output
    sudo apt --yes upgrade 2>&1 | log_output
else
    log "No apt or dnf package manager"
fi
log_end

log_update "Flatpack software"
if [ -x "$(command -v flatpak)" ]
then
    sudo flatpak update --assumeyes 2>&1 | log_output
else
    log "No flatpak software"
fi
log_end

log_update "SNAP software"
if [ -x "$(command -v snap)" ]
then
    sudo snap refresh 2>&1 | log_output
else
    log "No snap software"
fi
log_end

log_update "pyenv"
if [ -x $"(command -v pyenv)" ]
then
    pyenv update 2>&1 | log_output
else
    log "No pyenv software"
fi
log_end
